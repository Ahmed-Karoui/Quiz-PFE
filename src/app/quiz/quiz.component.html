<div class="row">
  <div class="col-8 col-md-9 col-lg-10">
    <h3>{{ quiz.name }}</h3>
    <p>{{ quiz.description }}</p>
  </div>

  <div class="col-4 col-md-3 col-lg-2 text-right">
    <div class="input-group input-group-sm mb-3">
      <select
        class="form-select"
        [(ngModel)]="quizName"
        (change)="loadQuiz(quizName)"
      >
        <option *ngFor="let quiz of quizes" [value]="quiz.id">
          {{ quiz.name }}
        </option>
      </select>
    </div>
  </div>
</div>

<div>
  <ng-container *ngIf="quiz" [ngSwitch]="true">
    <ng-container *ngSwitchCase="mode === 'quiz'">
      <form *ngIf="form" [formGroup]="form">
        <div formArrayName="questions">
          <div
            *ngFor="
              let question of form['controls'].questions['controls'];
              let qIndex = index
            "
          >
            <fieldset [formGroupName]="qIndex" class="card question">
              <h4>
                {{ qIndex + 1 }}. {{ question?.value?.question | titlecase }}
              </h4>

              <br />

              <div formArrayName="options">
                <div
                  *ngFor="
                    let option of question['controls'].options['controls'];
                    let oIndex = index
                  "
                >
                  <div class="form-check" [formGroupName]="oIndex">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      [value]="true"
                      formControlName="value"
                      [id]="value"
                    />
                    <label class="form-check-label" [attr.for]="value">{{
                      option?.value?.name
                    }}</label>
                  </div>
                </div>
              </div>
              <!-- option End-->
            </fieldset>
          </div>
        </div>
      </form>
    </ng-container>

    <ng-container *ngSwitchCase="mode === 'review'">
      <ol>
        <li *ngFor="let question of form?.value?.questions; let index = index">
          <span>{{ question?.question | titlecase }}</span>

          <ul class="mb-3">
            <ng-container *ngFor="let option of question?.options">
              <li *ngIf="option?.value">
                {{ option.name + ', ' }}
              </li>
            </ng-container>
          </ul>
        </li>
      </ol>
    </ng-container>

    <ng-container *ngSwitchCase="mode === 'result'">
      <h2>Quiz Result</h2>

      <h4 class="alert alert-info text-center">...</h4>

      <h4 class="alert alert-info text-center">
        You may close this window now.
      </h4>
    </ng-container>
  </ng-container>

  <hr />

  <div class="row">
    <div class="col-9">
      <button
        class="btn btn-light"
        [disabled]="mode === 'quiz'"
        (click)="mode = 'quiz'"
      >
        Quiz
      </button>

      <button
        class="btn btn-light mx-2"
        [disabled]="mode === 'review'"
        (click)="mode = 'review'"
      >
        Review
      </button>
    </div>

    <div class="col-3">
      <button type="button" class="btn btn-primary" (click)="onSubmit()">
        Submit Quiz
      </button>
    </div>
  </div>

  <hr />
</div>
